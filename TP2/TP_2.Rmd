---
title: "TP 2"
author: "Branger Anton"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Chargement des packages
```{r}
library(panelr)
library(dplyr)
library(plm)
library(ggplot2)
library(plyr)
library(haven)
```

# Question 2 

Importation des données
```{r}
psid_ind_1979_1999 <- read_dta("psid_ind_1979_1999.dta")
```

# Question 3

Il y a 123237 observations, 10 variables et l'unité d'observation est la variable IDPN

# Question 4

```{r}
panel <- pdata.frame(psid_ind_1979_1999, index = c("IDPN", "year"), drop.index = TRUE, row.names = TRUE)
pdim(panel)
```

# Question 5 

a) 
```{r}
psid1 <- psid_ind_1979_1999 %>% 
  filter(workhours > 0, 
         labor_inc > 0)
panel_1 <- pdata.frame(psid1, index = c("IDPN", "year"), drop.index = TRUE, row.names = TRUE)
pdim(panel_1)
```

b) 
```{r}
psid_men <- psid1 %>% 
  filter(sex == 1)
panel_men <- pdata.frame(psid_men, index = c("IDPN", "year"), drop.index = TRUE, row.names = TRUE)
pdim(panel_men)
```

# Question 6 

```{r}
psid_final <- psid_men %>% 
  mutate(ln_labor_inc = log(labor_inc),
         ln_workhours = log(workhours))
panel_final <- pdata.frame(psid_final, index = c("IDPN", "year"), drop.index = TRUE, row.names = TRUE)
pdim(panel_final)
```

```{r}
summary(panel_final$ln_labour_inc)
```

```{r}
summary(panel_final$ln_workhours)
```

# Question 7 

Variance
```{r}
var(panel_final$ln_workhours)
var(panel_final$ln_labor_inc)
```

Variance between
```{r}
var(Between(panel_final$ln_workhours))
var(Between(panel_final$ln_labor_inc))
```

Variance Within
```{r}
var(Within(panel_final$ln_workhours))
var(Within(panel_final$ln_labor_inc))
```

La variable ln_workhours a une variance between et within similaire c'est à dire que la variation temporelle et entreprise les individus est équivalente. 
La variable ln_labor_inc a une variance between plus importante que la variance within c'est à dire que la variation entre les individual est plus importante que la variable temporelle. 

# Question 8 

```{r}
my_model <- ln_workhours ~ ln_labor_inc
```

a) Pooled OLS
```{r}
reg_OLS <- lm(formula = my_model, data = panel_final)
summary(reg_OLS)
```

```{r}
reg_OLS2 <- plm(formula = my_model, data = panel_final)
summary(reg_OLS2)
```

