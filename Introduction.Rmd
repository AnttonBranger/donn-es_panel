---
title: "Introduction aux données de panel"
author: "Branger Antton"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Chargement des packages
```{r}
library(panelr)
library(dplyr)
library(plm)
library(ggplot2)
library(plyr)
library(haven)
```

# Question 2

Importation des données
```{r}
PSID_fam_long_commoninfo <- read_dta("PSID_fam_long_commoninfo.dta")
psid_ind_1979_1999 <- read_dta("psid_ind_1979_1999.dta")
psid_ind_2000_2019_wide <- read_dta("psid_ind_2000_2019_wide.dta")
psid_ind_2000_2019_long_reel <- read_dta("psid_ind_2000_2019_long.dta")
```

# Question 3

1. PSID_fam_long_commoninfo :
Nombre de variables : 5
Nombre d'observations : 267488
Unité d'observation : ID68 et intnum

2. psid_ind_1979_1999 :
Nombre de variables : 10
Nombre d'observations : 123237
Unité d'observation : IDPN

3. psid_ind_2000_2019_wide :
Nombre de variables : 49
Nombre d'observations : 10050
Unité d'observation : IDPN

# Question 4

```{r}
psid_ind_2000_2019_long <- long_panel(
  data = psid_ind_2000_2019_wide,       
  id = "IDPN",       
  wave = "year",        
  begin = 2001,          
  end = 2019,
  periods = c("2001", "2005", "2007", "2009", "2011", "2013", "2015", "2017", "2019"),
  label_location = "end",
  prefix = "_YEAR"
) 
```
On a maintenant 10 variables et 190950 observations 

# Question 5 

```{r}
psid_ind_1979_2019 <- rbind.fill(psid_ind_1979_1999, psid_ind_2000_2019_long)
```
On a maintenant 10 variables et 213687 observations. 

# Question 6

```{r}
psid <- merge(PSID_fam_long_commoninfo, psid_ind_1979_2019, 
              by = c("ID68", "intnum", "year"), 
              all.y = TRUE)
```
Nombre d'observations: 213687 identique à la table précédente (c'est ce que l'on voulait)
Nombre de variables : 12, logique car on rajoute les variables de la tables PSID_fam_long_commoninfo

# Question 7 

```{r}
psid_panel <- pdata.frame(psid, index = c("IDPN", "year"), drop.index = TRUE, row.names = TRUE)
pdim(psid_panel)
```
On a un panel non-cylindré de 25052 individus et 28 périodes de temps. 

# Question 9 : Données manquantes

```{r}
psid_panel %>% 
  ggplot(aes(x = age, y = workhours)) + 
  geom_point() + 
  labs(title = "Distribution des horaires de travail par rapport à l'âge",
       x = "Age",
       y = "Horaires travaillées")
```



